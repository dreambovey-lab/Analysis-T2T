ONT = read.xlsx("ONT.xlsx", sheet = 1)
ILMN = read.xlsx("ILMN.xlsx", sheet = 1) %>% mutate(Lab = gsub("_.*", "", Lab))
MGI = read.xlsx("MGI.xlsx", sheet = 1) %>% mutate(Lab = gsub("_.*", "", Lab))

ggsave("ONT_consensus.png", ggplot(ONT %>% select(Lab, Sample, Host_consensus, Non_host_consensus, Multi_labels, Host_reads_ground_truth) %>% unite("Sample", c(Sample, Lab)) %>% mutate(Sample = factor(Sample, levels = unique(Sample))) %>% pivot_longer(c("Non_host_consensus", "Multi_labels", "Host_consensus"), "Label") %>% mutate(Label = factor(Label, levels = c("Non_host_consensus", "Multi_labels", "Host_consensus"))), aes(x = Sample, y = value, fill = Label)) + geom_bar(stat = "identity", position = "stack") + theme_classic() + theme(legend.position = "top", axis.text.x = element_text(angle = 60, hjust = 1)) + scale_fill_manual(values = c("#A6CEE3", "grey90", "#FB9A99")) + labs(y = "Reads Count") + labs(x = ""), height = 9, width = 12)

ggsave("ILMN_consensus.png", ggplot(ILMN %>% select(Lab, Sample, Host_consensus, Non_host_consensus, Multi_labels, Host_reads_ground_truth) %>% unite("Sample", c(Sample, Lab)) %>% mutate(Sample = factor(Sample, levels = unique(Sample))) %>% pivot_longer(c("Non_host_consensus", "Multi_labels", "Host_consensus"), "Label") %>% mutate(Label = factor(Label, levels = c("Non_host_consensus", "Multi_labels", "Host_consensus"))), aes(x = Sample, y = value, fill = Label)) + geom_bar(stat = "identity", position = "stack") + theme_classic() + theme(legend.position = "top", axis.text.x = element_text(angle = 60, hjust = 1)) + scale_fill_manual(values = c("#A6CEE3", "grey90", "#FB9A99")) + labs(y = "Reads Count") + labs(x = ""), height = 9, width = 12)

ggsave("MGI_consensus.png", ggplot(MGI %>% select(Lab, Sample, Host_consensus, Non_host_consensus, Multi_labels, Host_reads_ground_truth) %>% unite("Sample", c(Sample, Lab)) %>% mutate(Sample = factor(Sample, levels = unique(Sample))) %>% pivot_longer(c("Non_host_consensus", "Multi_labels", "Host_consensus"), "Label") %>% mutate(Label = factor(Label, levels = c("Non_host_consensus", "Multi_labels", "Host_consensus"))), aes(x = Sample, y = value, fill = Label)) + geom_bar(stat = "identity", position = "stack") + theme_classic() + theme(legend.position = "top", axis.text.x = element_text(angle = 60, hjust = 1)) + scale_fill_manual(values = c("#A6CEE3", "grey90", "#FB9A99")) + labs(y = "Reads Count") + labs(x = ""), height = 9, width = 12)